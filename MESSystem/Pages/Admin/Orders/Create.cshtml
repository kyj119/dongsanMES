@page
@model MESSystem.Pages.Admin.Orders.CreateModel
@{
    ViewData["Title"] = "Ï£ºÎ¨∏ÏÑú ÏûëÏÑ±";
}

<div class="container-fluid mt-4">
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0"><i class="bi bi-file-earmark-plus"></i> Ï£ºÎ¨∏ÏÑú ÏûëÏÑ±</h4>
        </div>
        <div class="card-body">
            <form method="post" enctype="multipart/form-data" id="orderForm">
                
                <!-- Í±∞ÎûòÏ≤ò Ï†ïÎ≥¥ -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Í±∞ÎûòÏ≤ò Ï†ïÎ≥¥</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Input.ClientName" class="form-label">
                                    Í±∞ÎûòÏ≤òÎ™Ö <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Input.ClientName" class="form-control" 
                                       id="clientName" 
                                       placeholder="Í±∞ÎûòÏ≤òÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (ÏûêÎèôÏôÑÏÑ±)"
                                       autocomplete="off" />
                                <input type="hidden" id="clientId" />
                                <div id="clientSuggestions" class="list-group position-absolute" style="z-index: 1000; max-height: 300px; overflow-y: auto; display: none;"></div>
                                <span asp-validation-for="Input.ClientName" class="text-danger"></span>
                                <small class="text-muted">üí° Í±∞ÎûòÏ≤òÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÎ©¥ ÏûêÎèôÏúºÎ°ú ÎÇòÎ®∏ÏßÄ Ï†ïÎ≥¥Í∞Ä Ï±ÑÏõåÏßëÎãàÎã§</small>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="Input.ClientPhone" class="form-label">
                                    Ï†ÑÌôîÎ≤àÌò∏
                                </label>
                                <input asp-for="Input.ClientPhone" class="form-control" placeholder="Ïòà: 02-1234-5678" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label asp-for="Input.ClientMobile" class="form-label">
                                    Ìú¥ÎåÄÌè∞
                                </label>
                                <input asp-for="Input.ClientMobile" class="form-control" placeholder="Ïòà: 010-1234-5678" />
                            </div>
                            <div class="col-md-6 mb-3">
                                <label asp-for="Input.ClientAddress" class="form-label">
                                    Ï£ºÏÜå
                                </label>
                                <input asp-for="Input.ClientAddress" class="form-control" placeholder="Ïòà: ÏÑúÏö∏Ïãú Í∞ïÎÇ®Íµ¨..." />
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ï∂úÍ≥† Ï†ïÎ≥¥ -->
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Ï∂úÍ≥† Ï†ïÎ≥¥</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label asp-for="Input.ShippingMethod" class="form-label">
                                    Ï∂úÍ≥†Î∞©Î≤ï <span class="text-danger">*</span>
                                </label>
                                <select asp-for="Input.ShippingMethod" class="form-select" id="shippingMethod">
                                    <option value="">-- ÏÑ†ÌÉù --</option>
                                    <option value="ÎåÄÏã†ÌÉùÎ∞∞">ÎåÄÏã†ÌÉùÎ∞∞</option>
                                    <option value="ÎåÄÏã†ÌôîÎ¨º">ÎåÄÏã†ÌôîÎ¨º</option>
                                    <option value="ÌïúÏßÑÌÉùÎ∞∞">ÌïúÏßÑÌÉùÎ∞∞</option>
                                    <option value="ÌÄµ">ÌÄµ</option>
                                    <option value="Ïö©Ï∞®">Ïö©Ï∞®</option>
                                    <option value="Î∞©Î¨∏ÏàòÎ†π">Î∞©Î¨∏ÏàòÎ†π</option>
                                    <option value="ÏßÅÏ†ëÎ∞∞ÏÜ°">ÏßÅÏ†ëÎ∞∞ÏÜ°</option>
                                </select>
                                <span asp-validation-for="Input.ShippingMethod" class="text-danger"></span>
                            </div>
                            <div class="col-md-4 mb-3" id="paymentMethodGroup" style="display:none;">
                                <label asp-for="Input.PaymentMethod" class="form-label">
                                    Í≤∞Ï†úÎ∞©Î≤ï <span class="text-danger" id="paymentRequired">*</span>
                                </label>
                                <select asp-for="Input.PaymentMethod" class="form-select" id="paymentMethod">
                                    <option value="">-- ÏÑ†ÌÉù --</option>
                                    <option value="Ï∞©Î∂à">Ï∞©Î∂à</option>
                                    <option value="ÏÑ†Î∂à">ÏÑ†Î∂à</option>
                                </select>
                                <span asp-validation-for="Input.PaymentMethod" class="text-danger"></span>
                            </div>
                            <div class="col-md-4 mb-3" id="shippingDateGroup">
                                <label asp-for="Input.ShippingDate" class="form-label">
                                    Ï∂úÍ≥†Ïùº <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Input.ShippingDate" type="date" class="form-control" />
                                <span asp-validation-for="Input.ShippingDate" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3" id="shippingTimeGroup" style="display:none;">
                                <label asp-for="Input.ShippingTime" class="form-label">
                                    Ï∂úÍ≥†ÏãúÍ∞Ñ <span class="text-danger" id="timeRequired">*</span>
                                </label>
                                <input asp-for="Input.ShippingTime" type="time" class="form-control" />
                                <span asp-validation-for="Input.ShippingTime" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÌíàÎ™© Ï†ïÎ≥¥ -->
                <div class="card mb-4">
                    <div class="card-header bg-light d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">ÌíàÎ™© Ï†ïÎ≥¥</h5>
                        <span class="text-muted">ÌòÑÏû¨ Ï§Ñ: <strong id="currentRowCount">5</strong> / ÏµúÎåÄ: 20</span>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered" id="itemsTable">
                                <thead class="table-light">
                                    <tr>
                                        <th width="40">#</th>
                                        <th width="200">ÌíàÎ™© <span class="text-danger">*</span></th>
                                        <th width="150">Í∑úÍ≤©</th>
                                        <th width="200">ÎÇ¥Ïö©</th>
                                        <th width="100">ÏàòÎüâ <span class="text-danger">*</span></th>
                                        <th width="100">Îã®Í∞Ä</th>
                                        <th width="250">ÎîîÏûêÏù∏ÌååÏùº</th>
                                        <th width="150">ÎπÑÍ≥†</th>
                                        <th width="60"></th>
                                    </tr>
                                </thead>
                                <tbody id="itemsTableBody">
                                    <!-- Ï¥àÍ∏∞ 5Ï§Ñ -->
                                    @for (int i = 0; i < 5; i++)
                                    {
                                        <tr class="item-row" data-row-index="@i">
                                            <td class="text-center row-number">@(i + 1)</td>
                                            <td class="position-relative">
                                                <input type="text" 
                                                       class="form-control form-control-sm product-search-input" 
                                                       placeholder="ÌíàÎ™©Î™Ö ÎòêÎäî ÏΩîÎìú Í≤ÄÏÉâ..."
                                                       autocomplete="off"
                                                       data-row="@i" />
                                                <input type="hidden" name="Input.Items[@i].ProductId" class="product-id-input" />
                                                <div class="product-suggestions position-absolute bg-white border rounded shadow-sm" 
                                                     style="display:none; z-index: 1000; max-height: 200px; overflow-y: auto; width: 100%;"></div>
                                            </td>
                                            <td>
                                                <input type="text" name="Input.Items[@i].Spec" class="form-control form-control-sm spec-input" placeholder="Ïòà: 1000x2000mm" />
                                            </td>
                                            <td>
                                                <input type="text" name="Input.Items[@i].Description" class="form-control form-control-sm" placeholder="ÏÑ†ÌÉù ÏûÖÎ†•" />
                                            </td>
                                            <td>
                                                <input type="number" name="Input.Items[@i].Quantity" class="form-control form-control-sm" min="1" placeholder="0" />
                                            </td>
                                            <td>
                                                <input type="number" name="Input.Items[@i].UnitPrice" class="form-control form-control-sm" min="0" placeholder="0" />
                                            </td>
                                            <td>
                                                <input type="file" name="Input.Items[@i].DesignFile" class="form-control form-control-sm" accept=".ai,.psd,.pdf,.eps,.jpg,.png" />
                                            </td>
                                            <td>
                                                <input type="text" name="Input.Items[@i].Remark" class="form-control form-control-sm" placeholder="ÏÑ†ÌÉù ÏûÖÎ†•" />
                                            </td>
                                            <td class="text-center">
                                                <button type="button" class="btn btn-sm btn-outline-danger remove-row-btn" style="display:none;">
                                                    <i class="bi bi-x"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                        <div class="d-flex justify-content-between mt-3">
                            <button type="button" class="btn btn-outline-primary" id="addRowBtn">
                                <i class="bi bi-plus-circle"></i> Ï§Ñ Ï∂îÍ∞Ä
                            </button>
                            <div class="alert alert-info mb-0 py-2">
                                <small>
                                    <i class="bi bi-info-circle"></i> 
                                    ÌíàÎ™© ÏÑ†ÌÉù Ïãú Í∏∞Î≥∏ Í∑úÍ≤©Ïù¥ ÏûêÎèô ÏûÖÎ†•Îê©ÎãàÎã§. ÌïÑÏöîÏãú ÏàòÏ†ïÌïòÏÑ∏Ïöî.
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Î≤ÑÌäº -->
                <div class="d-flex justify-content-between">
                    <a asp-page="Index" class="btn btn-secondary">
                        <i class="bi bi-arrow-left"></i> Ï∑®ÏÜå
                    </a>
                    <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
                        <i class="bi bi-save"></i> Ï†ÄÏû• Î∞è Ïπ¥Îìú ÏÉùÏÑ±
                    </button>
                </div>

            </form>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/order-form.js"></script>
}
